Ly8gQXNzaWdubWVudC5jcHAgOiBUaGlzIGZpbGUgY29udGFpbnMgdGhlICdtYWluJyBmdW5jdGlvbi4gUHJvZ3JhbSBleGVjdXRpb24gYmVnaW5zIGFuZCBlbmRzIHRoZXJlLgojaW5jbHVkZSA8aW9zdHJlYW0+CiNpbmNsdWRlIDxzdHJpbmc+CiNpbmNsdWRlIDxpb21hbmlwPgoKdXNpbmcgbmFtZXNwYWNlIHN0ZDsKCnN0cnVjdCBDb2x1bW4gewoJaW50IGNvbEluZGV4ID0gLTE7CglpbnQgdmFsdWUgPSAtMTsKCUNvbHVtbiAqbmV4dCA9IE5VTEw7Cn07CgpzdHJ1Y3QgTGlua2VkUm93IHsKCWludCByb3dJbmRleCA9IC0xOwoJTGlua2VkUm93ICpuZXh0Um93ID0gTlVMTDsKCUNvbHVtbiAqZmlyc3RDb2wgPSBOVUxMOwoKCUxpbmtlZFJvdyhpbnQgckluZGV4LCBpbnQgY0luZGV4LCBpbnQgdmFsdWUpOwoJfkxpbmtlZFJvdygpOwoJdm9pZCByZWFkQ29sdW1uKGludCBjb2x1bW4sIGludCB2YWx1ZSk7Cn07CgpMaW5rZWRSb3c6OkxpbmtlZFJvdyhpbnQgckluZGV4LCBpbnQgY0luZGV4LCBpbnQgdmFsdWUpIHsgLy8gVGhpcyBpcyBhIGNvbnN0cnVjdG9yLCB0aGUgcmVhc29uIGl0IGFjY2VwdCByb3csY29sdW1uIGFuZCB2YWx1ZSBpcyAtPiB5b3Ugb25seSBjcmVhdGUgbmV3IHJvdyBpZiB0aGVyZSBhcmUgdmFsdWUgaW4gdGhhdCByb3cgLCBzbyB3ZSBzaW1wbGlmeSB0aGUgd29yay4KCXJvd0luZGV4ID0gckluZGV4OwoJZmlyc3RDb2wgPSBuZXcgQ29sdW1uKCk7CglmaXJzdENvbC0+Y29sSW5kZXggPSBjSW5kZXg7CglmaXJzdENvbC0+dmFsdWUgPSB2YWx1ZTsKfQpMaW5rZWRSb3c6On5MaW5rZWRSb3coKSB7CglDb2x1bW4gKiBjdXJyZW50ID0gZmlyc3RDb2w7CglDb2x1bW4gKiBuZXh0QyA9IE5VTEw7Cgl3aGlsZSAoY3VycmVudCAhPSBOVUxMKSB7CgkJbmV4dEMgPSBjdXJyZW50LT5uZXh0OwoJCWRlbGV0ZSBjdXJyZW50OwoJCWN1cnJlbnQgPSBuZXh0QzsKCX0KCWRlbGV0ZSBjdXJyZW50OwoJZGVsZXRlIG5leHRDOwoJY3VycmVudCA9IE5VTEw7CgluZXh0QyA9IE5VTEw7Cn0Kdm9pZCBMaW5rZWRSb3c6OnJlYWRDb2x1bW4oaW50IGNvbHVtbiwgaW50IHZhbHVlKSB7CglDb2x1bW4gKmxvb3BOb2RlID0gdGhpcy0+Zmlyc3RDb2w7Cgl3aGlsZSAobG9vcE5vZGUgIT0gTlVMTCkgewoJCS8vY2hlY2sgaWYgY29sdW1uIGFscmVhZHkgZXhpc3QKCQlpZiAobG9vcE5vZGUtPmNvbEluZGV4ID09IGNvbHVtbikgewoJCQkvL3VwZGF0ZSBuZXcgdmFsdWUgaWYgZXhpc3QKCQkJbG9vcE5vZGUtPnZhbHVlID0gdmFsdWU7CgkJCWJyZWFrOwoJCX0gZWxzZSB7CgkJCS8vY3JlYXRlIGEgbmV3IG5vZGUKCQkJaWYgKGxvb3BOb2RlLT5uZXh0ID09IE5VTEwpIHsKCQkJCUNvbHVtbiAqbmV3Q29sdW1uID0gbmV3IENvbHVtbigpOwoJCQkJbmV3Q29sdW1uLT5jb2xJbmRleCA9IGNvbHVtbjsKCQkJCW5ld0NvbHVtbi0+dmFsdWUgPSB2YWx1ZTsKCQkJCWlmIChsb29wTm9kZS0+Y29sSW5kZXggPCBjb2x1bW4pIHsKCQkJCQluZXdDb2x1bW4tPm5leHQgPSBOVUxMOwoJCQkJCWxvb3BOb2RlLT5uZXh0ID0gbmV3Q29sdW1uOwoJCQkJfSBlbHNlIHsKCQkJCQluZXdDb2x1bW4tPm5leHQgPSB0aGlzLT5maXJzdENvbDsKCQkJCQl0aGlzLT5maXJzdENvbCA9IG5ld0NvbHVtbjsKCQkJCX0KCQkJCWJyZWFrOwoJCQl9IGVsc2UgewoJCQkJaWYgKGxvb3BOb2RlLT5jb2xJbmRleCA8IGNvbHVtbiAmJiBsb29wTm9kZS0+bmV4dC0+Y29sSW5kZXggPiBjb2x1bW4pIHsKCQkJCQlDb2x1bW4gKm5ld0NvbHVtbiA9IG5ldyBDb2x1bW4oKTsKCQkJCQluZXdDb2x1bW4tPmNvbEluZGV4ID0gY29sdW1uOwoJCQkJCW5ld0NvbHVtbi0+dmFsdWUgPSB2YWx1ZTsKCQkJCQluZXdDb2x1bW4tPm5leHQgPSBsb29wTm9kZS0+bmV4dDsKCQkJCQlsb29wTm9kZS0+bmV4dCA9IG5ld0NvbHVtbjsKCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCX0KCQlsb29wTm9kZSA9IGxvb3BOb2RlLT5uZXh0OwoJfQp9CgpjbGFzcyBVVE0gewoJaW50IHJvd1NpemU7CglpbnQgY29sdW1uU2l6ZTsKcHVibGljOgoJTGlua2VkUm93ICpmaXJzdFJvdyA9IE5VTEw7CgoJVVRNKGludCByb3dzLCBpbnQgY29sdW1ucyk7Cgl+VVRNKCk7Cgl2b2lkIGRpc3BsYXlFbGVtZW50cyhpbnQgcm93LCBpbnQgY29sdW1uLCBpbnQgdmFsdWUpOwoJdm9pZCBwcmludE1hdHJpeCgpOwoJVVRNICogYWRkU00oVVRNICZvdGhlcik7Cglib29sIGlzU2xvdFJlc2VydmVkKGludCByb3csIGludCBjb2x1bW4pOwoJYm9vbCBpc0V4Y2VlZFNpemUoaW50IHJvdywgaW50IGNvbHVtbik7Cglib29sIGlzU2FtZVNpemUoVVRNICZvdGhlcik7Cn07CgpVVE06OlVUTShpbnQgcm93cywgaW50IGNvbHVtbnMpIHsKCXJvd1NpemUgPSByb3dzOwoJY29sdW1uU2l6ZSA9IGNvbHVtbnM7Cn0KVVRNOjp+VVRNKCkgewoJTGlua2VkUm93ICogY3VycmVudCA9IGZpcnN0Um93OwoJTGlua2VkUm93ICogbmV4dEMgPSBOVUxMOwoJd2hpbGUgKGN1cnJlbnQgIT0gTlVMTCkgewoJCW5leHRDID0gY3VycmVudC0+bmV4dFJvdzsKCQlkZWxldGUgY3VycmVudDsKCQljdXJyZW50ID0gbmV4dEM7Cgl9CglkZWxldGUgY3VycmVudDsKCWRlbGV0ZSBuZXh0QzsKCWN1cnJlbnQgPSBOVUxMOwoJbmV4dEMgPSBOVUxMOwp9CnZvaWQgVVRNOjpkaXNwbGF5RWxlbWVudHMoaW50IHJvdywgaW50IGNvbHVtbiwgaW50IHZhbHVlKSB7CglpZiAoZmlyc3RSb3cgPT0gTlVMTCkgeyAvL0lmIHByZXZpb3VzbHkgbm8gcm93ICh3aGljaCBtZWFucyB0aGlzIGlzIGEgbmV3bHkgY3JlYXRlZCBtYXRyaXgpLCB0aGVuIGFkZCByb3csIGVsc2UgZmluZCB0aGUgcm93cwoJCUxpbmtlZFJvdyAqbmV3Um93ID0gbmV3IExpbmtlZFJvdyhyb3csIGNvbHVtbiwgdmFsdWUpOwoJCXRoaXMtPmZpcnN0Um93ID0gbmV3Um93OwoJfSBlbHNlIHsKCQlMaW5rZWRSb3cgKmxvb3BSb3cgPSB0aGlzLT5maXJzdFJvdzsKCQl3aGlsZSAobG9vcFJvdyAhPSBOVUxMKSB7CgkJCWlmIChsb29wUm93LT5yb3dJbmRleCA9PSByb3cpIHsKCQkJCWxvb3BSb3ctPnJlYWRDb2x1bW4oY29sdW1uLCB2YWx1ZSk7CgkJCQlicmVhazsKCQkJfSBlbHNlIHsKCQkJCWlmIChsb29wUm93LT5uZXh0Um93ID09IE5VTEwpIHsKCQkJCQlMaW5rZWRSb3cgKm5ld1JvdyA9IG5ldyBMaW5rZWRSb3cocm93LCBjb2x1bW4sIHZhbHVlKTsKCQkJCQlpZiAobG9vcFJvdy0+cm93SW5kZXggPCByb3cpIHsKCQkJCQkJbG9vcFJvdy0+bmV4dFJvdyA9IG5ld1JvdzsKCQkJCQkJY291dCA8PCAiYWFhIiA8PCBlbmRsOwoJCQkJCX0gZWxzZSB7CgkJCQkJCW5ld1Jvdy0+bmV4dFJvdyA9IHRoaXMtPmZpcnN0Um93OwoJCQkJCQl0aGlzLT5maXJzdFJvdyA9IG5ld1JvdzsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQl9IGVsc2UgewoJCQkJCWlmIChsb29wUm93LT5yb3dJbmRleCA8IHJvdyAmJiBsb29wUm93LT5uZXh0Um93LT5yb3dJbmRleCA+IHJvdykgewoJCQkJCQlMaW5rZWRSb3cgKm5ld1JvdyA9IG5ldyBMaW5rZWRSb3cocm93LCBjb2x1bW4sIHZhbHVlKTsKCQkJCQkJbmV3Um93LT5uZXh0Um93ID0gbG9vcFJvdy0+bmV4dFJvdzsKCQkJCQkJbG9vcFJvdy0+bmV4dFJvdyA9IG5ld1JvdzsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCWxvb3BSb3cgPSBsb29wUm93LT5uZXh0Um93OwoJCX0KCX0KfQovL1JlYWQgVmFsdWUKdm9pZCBVVE06OnByaW50TWF0cml4KCkgewoJTGlua2VkUm93ICpsb29wUm93ID0gdGhpcy0+Zmlyc3RSb3c7Cgljb3V0IDw8IHNldHcoNSk7IC8vQ2xlYXIgcHJldmlvdXMgbGluZQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gdGhpcy0+cm93U2l6ZTsgaSsrKSB7CgkJaWYgKGxvb3BSb3cgPT0gTlVMTCB8fCBsb29wUm93LT5yb3dJbmRleCAhPSBpKSB7IC8vIFRoaXMgaXMgZm9yIHJvd3MgdGhhdCBoYXZlIG5vIHZhbHVlCgkJCWZvciAoaW50IGogPSAxOyBqIDw9IHRoaXMtPmNvbHVtblNpemU7IGorKykgewoJCQkJY291dCA8PCAiMCIgPDwgc2V0dyg1KTsKCQkJfQoJCX0gZWxzZSB7IC8vIFRoaXMgaXMgcm93cyB0aGF0IGhhdmUgdmFsdWUKCQkJQ29sdW1uICpsb29wQ29sdW1uID0gbG9vcFJvdy0+Zmlyc3RDb2w7IC8vU2VsZWN0aW5nIGZpcnN0IGNvbHVtbiB3aXRoIG5vbi16ZXJvIHZhbHVlCgkJCWZvciAoaW50IGogPSAxOyBqIDw9IHRoaXMtPmNvbHVtblNpemU7IGorKykgeyAvL1N0YXJ0IGRpc3BsYXkgZnJvbSBmaXJzdCBjb2x1bW4KCQkJCWlmIChsb29wQ29sdW1uID09IE5VTEwgfHwgbG9vcENvbHVtbi0+Y29sSW5kZXggIT0gaikgey8vQ2hlY2sgY29sdW1uIGluZGV4LCBpZiBub3Qgc2FtZSBtZWFucyB0aGF0IGNvbHVtbiBkb2VzIG5vdCBoYXZlIHZhbHVlLgoJCQkJCWNvdXQgPDwgIjAiIDw8IHNldHcoNSk7CgkJCQl9IGVsc2UgeyAvL0lmIGluZGV4IGlzIFNBTSB0RWhlbiBTSE9XIHZhbHVlIHdoZW4gaXQsIHRoZW4gb25seSBzZWxlY3QgdGhlIE5FWFQgbm9kZSwgZWxzZSBpdCB3aWxsIGNvbnRpbnVlIGNoZWNraW5nCgkJCQkJY291dCA8PCBsb29wQ29sdW1uLT52YWx1ZSA8PCBzZXR3KDUpOwoJCQkJCWxvb3BDb2x1bW4gPSBsb29wQ29sdW1uLT5uZXh0OwoJCQkJfQoJCQl9CgkJCWxvb3BSb3cgPSBsb29wUm93LT5uZXh0Um93OwoJCX0KCQljb3V0IDw8IGVuZGw7IC8vWWF5LCB0aGlzIHJvdyBpcyBkb25lIGRpc3BsYXlpbmchIE5leHQgUk9XV1cKCX0KfQoKVVRNICogVVRNOjphZGRTTShVVE0gJm90aGVyKSB7CglMaW5rZWRSb3cgKmZpcnN0U01Sb3cgPSB0aGlzLT5maXJzdFJvdzsKCUxpbmtlZFJvdyAqc2Vjb25kU01Sb3cgPSBvdGhlci5maXJzdFJvdzsKCVVUTSAqIGFkZGVkVVRNID0gbmV3IFVUTSh0aGlzLT5yb3dTaXplLCB0aGlzLT5jb2x1bW5TaXplKTsKCgl3aGlsZSAoIShmaXJzdFNNUm93ID09IE5VTEwgJiYgc2Vjb25kU01Sb3cgPT0gTlVMTCkpIHsgLy9Mb29wIHVudGlsIGJvdGggbWF0cml4IGFyZSBkb25lCgkJQ29sdW1uICpmaXJzdFNNQ29sID0gTlVMTCwgKnNlY29uZFNNQ29sID0gTlVMTDsKCQlpbnQgZGlzcGxheWVkUm93ID0gMDsgLy8wID0gZGVmYXVsdCwgMSA9IGZpcnN0Um93LCAyID0gc2Vjb25kUm93LCAzID0gYm90aFJvdwoKCQlpZiAoZmlyc3RTTVJvdyAhPSBOVUxMICYmIHNlY29uZFNNUm93ICE9IE5VTEwpIHsgLy9JZiBib3RoIG1hdHJpeCBzdGlsbCBoYXZlIHJvdywgY29tcGFyZSB0aGVpciBpbmRleC4KCQkJaWYgKGZpcnN0U01Sb3ctPnJvd0luZGV4ID4gc2Vjb25kU01Sb3ctPnJvd0luZGV4KSB7IC8vSWYgc2Vjb25kIG1hdHJpeCBkb2VzIG5vdCBoYXZlIHRoYXQgcGFydGljdWxhciByb3cuICh3aGljaCBmaXJzdCBtYXRyaXggaGF2ZSkKCQkJCWNvdXQgPDwgInNlY29uZDoiIDw8IHNlY29uZFNNUm93LT5yb3dJbmRleCA8PCBlbmRsOwoJCQkJc2Vjb25kU01Db2wgPSBzZWNvbmRTTVJvdy0+Zmlyc3RDb2w7IC8vQXNzaWduIHNlY29uZCBtYXRyaXgncyBjb2x1bW4gdG8gYWRkIGxhdGVyLgoJCQkJZGlzcGxheWVkUm93ID0gMjsKCQkJfSBlbHNlIGlmIChmaXJzdFNNUm93LT5yb3dJbmRleCA8IHNlY29uZFNNUm93LT5yb3dJbmRleCkgeyAvL0lmIGZpcnN0IG1hdHJpeCBkb2VzIG5vdCBoYXZlIHRoYXQgcGFydGljdWxhciByb3cuICh3aGljaCBzZWNvbmQgbWF0cml4IGhhdmUpCgkJCQlmaXJzdFNNQ29sID0gZmlyc3RTTVJvdy0+Zmlyc3RDb2w7IC8vQXNzaWduIGZpcnN0IG1hdHJpeCdzIGNvbHVtbiB0byBhZGQgbGF0ZXIuCgkJCQlkaXNwbGF5ZWRSb3cgPSAxOwoJCQl9IGVsc2UgeyAvLyBJZiBib3RoIG1hdHJpeCBoYXZlIHRoYXQgY29sdW1uIGFzc2lnbiBjb2x1bW4gdG8gZGlzcGxheSBsYXRlcgoJCQkJY291dCA8PCAic2Vjb25kOiIgPDwgc2Vjb25kU01Sb3ctPnJvd0luZGV4IDw8IGVuZGw7CgkJCQlmaXJzdFNNQ29sID0gZmlyc3RTTVJvdy0+Zmlyc3RDb2w7CgkJCQlzZWNvbmRTTUNvbCA9IHNlY29uZFNNUm93LT5maXJzdENvbDsKCQkJCWRpc3BsYXllZFJvdyA9IDM7CgkJCX0KCQl9IGVsc2UgaWYgKGZpcnN0U01Sb3cgIT0gTlVMTCAmJiBzZWNvbmRTTVJvdyA9PSBOVUxMKSB7IC8vSWYgc2Vjb25kIG1hdHJpeCBoYXZlIGZpbmlzaCBhZGRpbmcKCQkJZmlyc3RTTUNvbCA9IGZpcnN0U01Sb3ctPmZpcnN0Q29sOyAvL0tlZXAgb24gYWRkaW5nIGZpcnN0IG1hdHJpeCB0byBuZXcgbWF0cml4CgkJCWRpc3BsYXllZFJvdyA9IDE7CgkJfSBlbHNlIGlmIChmaXJzdFNNUm93ID09IE5VTEwgJiYgc2Vjb25kU01Sb3cgIT0gTlVMTCkgeyAvL0lmIGZpcnN0IG1hdHJpeCBoYXZlIGZpbmlzaCBhZGRpbmcKCQkJc2Vjb25kU01Db2wgPSBzZWNvbmRTTVJvdy0+Zmlyc3RDb2w7IC8vS2VlcCBvbiBhZGRpbmcgc2Vjb25kIG1hdHJpeCB0byBuZXcgbWF0cml4CgkJCWRpc3BsYXllZFJvdyA9IDI7CgkJfQoKCQl3aGlsZSAoIShmaXJzdFNNQ29sID09IE5VTEwgJiYgc2Vjb25kU01Db2wgPT0gTlVMTCkpIHsKCQkJaWYgKGZpcnN0U01Db2wgIT0gTlVMTCAmJiBzZWNvbmRTTUNvbCA9PSBOVUxMKSB7CgkJCQljb3V0IDw8ICJTZWNvbmRTTUNvbCBpcyBOVUxMISIgPDwgZW5kbDsKCQkJCWFkZGVkVVRNLT5kaXNwbGF5RWxlbWVudHMoZmlyc3RTTVJvdy0+cm93SW5kZXgsIGZpcnN0U01Db2wtPmNvbEluZGV4LCBmaXJzdFNNQ29sLT52YWx1ZSk7CgkJCQlmaXJzdFNNQ29sID0gZmlyc3RTTUNvbC0+bmV4dDsKCQkJfSBlbHNlIGlmIChmaXJzdFNNQ29sID09IE5VTEwgJiYgc2Vjb25kU01Db2wgIT0gTlVMTCkgewoJCQkJY291dCA8PCAiRmlyc3RTTVJvdyBpcyBOVUxMISIgPDwgZW5kbDsKCQkJCWFkZGVkVVRNLT5kaXNwbGF5RWxlbWVudHMoc2Vjb25kU01Sb3ctPnJvd0luZGV4LCBzZWNvbmRTTUNvbC0+Y29sSW5kZXgsIHNlY29uZFNNQ29sLT52YWx1ZSk7CgkJCQlzZWNvbmRTTUNvbCA9IHNlY29uZFNNQ29sLT5uZXh0OwoJCQl9IGVsc2UgaWYgKGZpcnN0U01Db2wtPmNvbEluZGV4IDwgc2Vjb25kU01Db2wtPmNvbEluZGV4KSB7CgkJCQlhZGRlZFVUTS0+ZGlzcGxheUVsZW1lbnRzKGZpcnN0U01Sb3ctPnJvd0luZGV4LCBmaXJzdFNNQ29sLT5jb2xJbmRleCwgZmlyc3RTTUNvbC0+dmFsdWUpOwoJCQkJZmlyc3RTTUNvbCA9IGZpcnN0U01Db2wtPm5leHQ7CgkJCX0gZWxzZSBpZiAoc2Vjb25kU01Db2wtPmNvbEluZGV4IDwgZmlyc3RTTUNvbC0+Y29sSW5kZXgpIHsKCQkJCWFkZGVkVVRNLT5kaXNwbGF5RWxlbWVudHMoc2Vjb25kU01Sb3ctPnJvd0luZGV4LCBzZWNvbmRTTUNvbC0+Y29sSW5kZXgsIHNlY29uZFNNQ29sLT52YWx1ZSk7CgkJCQlzZWNvbmRTTUNvbCA9IHNlY29uZFNNQ29sLT5uZXh0OwoJCQl9IGVsc2UgaWYgKGZpcnN0U01Db2wtPmNvbEluZGV4ID09IHNlY29uZFNNQ29sLT5jb2xJbmRleCkgewoJCQkJY291dCA8PCAiU2FtZSByb3c6IiA8PCBmaXJzdFNNUm93LT5yb3dJbmRleCA8PCAiU2FtZSBDb2w6IiA8PCBmaXJzdFNNQ29sLT5jb2xJbmRleCA8PCAiVmFsdWU6IiA8PCBmaXJzdFNNQ29sLT52YWx1ZSA8PCBlbmRsOwoJCQkJaW50IHN1bSA9IGZpcnN0U01Db2wtPnZhbHVlICsgc2Vjb25kU01Db2wtPnZhbHVlOwoJCQkJYWRkZWRVVE0tPmRpc3BsYXlFbGVtZW50cyhmaXJzdFNNUm93LT5yb3dJbmRleCwgZmlyc3RTTUNvbC0+Y29sSW5kZXgsIHN1bSk7CgkJCQlmaXJzdFNNQ29sID0gZmlyc3RTTUNvbC0+bmV4dDsKCQkJCXNlY29uZFNNQ29sID0gc2Vjb25kU01Db2wtPm5leHQ7CgkJCX0gZWxzZSB7CgkJCQljb3V0IDw8ICJFcnJvciBpbiBhZGRpbmchIiA8PCBlbmRsOwoJCQkJY291dCA8PCAiRmlyc3QgU00gUm93OiIgPDwgZmlyc3RTTVJvdy0+cm93SW5kZXggPDwgIixDb2w6IiA8PCBmaXJzdFNNQ29sLT5jb2xJbmRleCA8PCAiLFZhbHVlOiIgPDwgZmlyc3RTTUNvbC0+dmFsdWUgPDwgIixIYXZlIE5leHQ6IiA8PCAoZmlyc3RTTUNvbC0+bmV4dCA9PSBOVUxMKSA8PCBlbmRsOwoJCQkJY291dCA8PCAic2Vjb25kIFNNIFJvdzoiIDw8IHNlY29uZFNNUm93LT5yb3dJbmRleCA8PCAiLENvbDoiIDw8IHNlY29uZFNNQ29sLT5jb2xJbmRleCA8PCAiLFZhbHVlOiIgPDwgc2Vjb25kU01Db2wtPnZhbHVlIDw8ICIsSGF2ZSBOZXh0OiIgPDwgKHNlY29uZFNNQ29sLT5uZXh0ID09IE5VTEwpIDw8IGVuZGw7CgkJCX0KCQl9CgoJCXN3aXRjaCAoZGlzcGxheWVkUm93KSB7CgkJCWNhc2UgMToKCQkJCWZpcnN0U01Sb3cgPSBmaXJzdFNNUm93LT5uZXh0Um93OwoJCQkJYnJlYWs7CgkJCWNhc2UgMjoKCQkJCXNlY29uZFNNUm93ID0gc2Vjb25kU01Sb3ctPm5leHRSb3c7CgkJCQlicmVhazsKCQkJY2FzZSAzOgoJCQkJZmlyc3RTTVJvdyA9IGZpcnN0U01Sb3ctPm5leHRSb3c7CgkJCQlzZWNvbmRTTVJvdyA9IHNlY29uZFNNUm93LT5uZXh0Um93OwoJCQkJYnJlYWs7CgkJCWRlZmF1bHQ6CgkJCQljb3V0IDw8ICI/Pz8/Pz8iIDw8IGVuZGw7CgkJCQlicmVhazsKCQl9Cgl9CgoJcmV0dXJuIGFkZGVkVVRNOwp9Cgpib29sIFVUTTo6aXNFeGNlZWRTaXplKGludCByb3csIGludCBjb2x1bW4pIHsKCXJldHVybiAocm93IDw9IDAgfHwgcm93ID4gdGhpcy0+cm93U2l6ZSB8fCBjb2x1bW4gPD0gMCB8fCBjb2x1bW4gPiB0aGlzLT5jb2x1bW5TaXplKTsKfQoKYm9vbCBVVE06OmlzU2xvdFJlc2VydmVkKGludCByb3csIGludCBjb2x1bW4pIHsKCXJldHVybiAoY29sdW1uIDw9IChyb3cgLSAxKSk7Cn0KCmJvb2wgVVRNOjppc1NhbWVTaXplKFVUTSAmb3RoZXIpIHsKCXJldHVybiAodGhpcy0+cm93U2l6ZSA9PSBvdGhlci5yb3dTaXplICYmIHRoaXMtPmNvbHVtblNpemUgPT0gb3RoZXIuY29sdW1uU2l6ZSk7Cn0KCmludCBtYWluKCkgewoJVVRNICogdGVtcFVUTTsKCVVUTSBmaXJzdFNNKDQsIDQpOwoJVVRNIHNlY29uZFNNKDQsIDQpOwpzaG93TWVudToKCXN0cmluZyBpbnB1dDsKCWludCBzZWxlY3Rpb24gPSAwOwoJc3lzdGVtKCJjbHMiKTsKCWNvdXQgPDwgIlBsZWFzZSBzZWxlY3Qgb25lIG9wdGlvbiBmcm9tIHRoZSBtZW51IGJlbG93LiIgPDwgZW5kbDsKCWNvdXQgPDwgIjEuU2hvdyBNYXRyaXgiIDw8IGVuZGw7Cgljb3V0IDw8ICIyLkNyZWF0ZSBGaXJzdCBNYXRyaXgiIDw8IGVuZGw7Cgljb3V0IDw8ICIzLkNyZWF0ZSBTZWNvbmQgTWF0cml4IiA8PCBlbmRsOwoJY291dCA8PCAiNC5TdW0gVHdvIE1hdHJpeCIgPDwgZW5kbDsKCWNvdXQgPDwgIjUuQ2xlYXIgTWVtb3J5IiA8PCBlbmRsOwoJY291dCA8PCAiNi5FeGl0IFByb2dyYW0iIDw8IGVuZGw7CgljaW4gPj4gc2VsZWN0aW9uOwoKCXN3aXRjaCAoc2VsZWN0aW9uKSB7CgkJY2FzZSAxOgoJCQljb3V0IDw8ICJTaG93IHdoaWNoIG1hdHJpeD8gKDEgb3IgMikiIDw8IGVuZGw7CgkJCWNpbiA+PiBzZWxlY3Rpb247CgkJCWNvdXQgPDwgZW5kbDsKCQkJc3dpdGNoIChzZWxlY3Rpb24pIHsKCQkJCWNhc2UgMToKCQkJCQlmaXJzdFNNLnByaW50TWF0cml4KCk7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDI6CgkJCQkJc2Vjb25kU00ucHJpbnRNYXRyaXgoKTsKCQkJCQlicmVhazsKCQkJCWRlZmF1bHQ6CgkJCQkJY291dCA8PCAiVGhpcyBtYXRyaXggZG9lcyBub3QgZXhpc3QiIDw8IGVuZGw7CgkJCQkJZ290byBzaG93TWVudTsKCQkJfQoJCQljb3V0IDw8IGVuZGw7CgkJCXN5c3RlbSgicGF1c2UiKTsKCQkJZ290byBzaG93TWVudTsKCQkJYnJlYWs7CgkJY2FzZSAyOgoJCQlpbnQgcm93U2l6ZSwgY29sdW1uU2l6ZTsKCQkJY291dCA8PCAiUGxlYXNlIGlucHV0IGZpcnN0IG1hdHJpeCBzaXplOiIgPDwgZW5kbDsKZGVjbGFyZUZNU2l6ZToKCQkJY291dCA8PCAiUm93OiI7CgkJCWNpbiA+PiByb3dTaXplOwoJCQljb3V0IDw8ICJDb2x1bW46IjsKCQkJY2luID4+IGNvbHVtblNpemU7CgkJCWlmIChyb3dTaXplIDw9IDAgfHwgY29sdW1uU2l6ZSA8PSAwKSB7CgkJCQljb3V0IDw8ICJUaGUgc2l6ZSB5b3UgaGFkIGVudGVyZWQgaXMgaW52YWxpZCEgUGxlYXNlIGVudGVyIGEgdmFsaWQgc2l6ZS4iIDw8IGVuZGw7CgkJCQlnb3RvIGRlY2xhcmVGTVNpemU7CgkJCX0gZWxzZSBpZiAocm93U2l6ZSAhPSBjb2x1bW5TaXplKSB7CgkJCQljb3V0IDw8ICJSb3cgc2l6ZSBtdXN0IGJlIHNhbWUgd2l0aCBjb2x1bW4gc2l6ZSIgPDwgZW5kbDsKCQkJCWdvdG8gZGVjbGFyZUZNU2l6ZTsKCQkJfQoJCQlmaXJzdFNNID0gVVRNKHJvd1NpemUsIGNvbHVtblNpemUpOwoJCQljb3V0IDw8ICJQbGVhc2UgaW5wdXQgdmFsdWUgZm9yIGZpcnN0IG1hdHJpeCAoSW5kZXggc3RhcnRpbmcgZnJvbSAxKSIgPDwgZW5kbDsKCQkJd2hpbGUgKHRydWUpIHsKCQkJCWludCByb3csIGNvbHVtbiwgdmFsdWU7CgkJCQljb3V0IDw8ICJbUm93XSAtPiAiOwoJCQkJY2luID4+IHJvdzsKCQkJCWNvdXQgPDwgIltDb2x1bW5dIC0+ICI7CgkJCQljaW4gPj4gY29sdW1uOwoJCQkJY291dCA8PCAiW1ZhbHVlXSAtPiAiOwoJCQkJY2luID4+IHZhbHVlOwoJCQkJaWYgKGZpcnN0U00uaXNFeGNlZWRTaXplKHJvdywgY29sdW1uKSkgewoJCQkJCWNvdXQgPDwgIkludmFsaWQgcm93IG9yIGNvbHVtbiEgUGxlYXNlIGVudGVyIHZhbHVlIHdpdGhpbiB0aGUgbWF0cml4IHNpemUhIiA8PCBlbmRsOwoJCQkJfSBlbHNlIGlmIChmaXJzdFNNLmlzU2xvdFJlc2VydmVkKHJvdywgY29sdW1uKSkgewoJCQkJCWNvdXQgPDwgIlRoZSByb3cgb3IgY29sdW1uIHN0YXRlZCBpcyBub3QgYXZhaWFibGUgZm9yIFVwcGVyIFRyaWFuZ3VsYXIgTWF0cml4ISIgPDwgZW5kbDsKCQkJCX0gZWxzZSBpZiAodmFsdWUgPT0gMCkgewoJCQkJCWNvdXQgPDwgIlRoZSB2YWx1ZSBtdXN0IG5vdCBiZSAwICEiIDw8IGVuZGw7CgkJCQl9IGVsc2UgewoJCQkJCWZpcnN0U00uZGlzcGxheUVsZW1lbnRzKHJvdywgY29sdW1uLCB2YWx1ZSk7CgkJCQkJY291dCA8PCAiVmFsdWUgYWRkZWQuLi4iIDw8IGVuZGw7CgkJCQl9CgkJCQljb3V0IDw8ICJDb250aW51ZSBpbnB1dCBuZXh0IHZhbHVlPyAoWS9OKSIgPDwgZW5kbDsKCQkJCWNpbiA+PiBpbnB1dDsKCQkJCWlmICghKGlucHV0ICE9ICJZIiAmJiBpbnB1dCAhPSAieSIpKSB7CgkJCQl9IGVsc2UgewoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJCWdvdG8gc2hvd01lbnU7CgkJCWJyZWFrOwoJCWNhc2UgMzoKCQkJY291dCA8PCAiUGxlYXNlIGlucHV0IHNlY29uZCBtYXRyaXggc2l6ZToiIDw8IGVuZGw7CmRlY2xhcmVTTVNpemU6CgkJCWNvdXQgPDwgIlJvdzoiOwoJCQljaW4gPj4gcm93U2l6ZTsKCQkJY291dCA8PCAiQ29sdW1uOiI7CgkJCWNpbiA+PiBjb2x1bW5TaXplOwoJCQlpZiAocm93U2l6ZSA8PSAwIHx8IGNvbHVtblNpemUgPD0gMCkgewoJCQkJY291dCA8PCAiVGhlIHNpemUgeW91IGhhZCBlbnRlcmVkIGlzIGludmFsaWQhIFBsZWFzZSBlbnRlciBhIHZhbGlkIHNpemUuIiA8PCBlbmRsOwoJCQkJZ290byBkZWNsYXJlU01TaXplOwoJCQl9IGVsc2UgaWYgKHJvd1NpemUgIT0gY29sdW1uU2l6ZSkgewoJCQkJY291dCA8PCAiUm93IHNpemUgbXVzdCBiZSBzYW1lIHdpdGggY29sdW1uIHNpemUiIDw8IGVuZGw7CgkJCQlnb3RvIGRlY2xhcmVTTVNpemU7CgkJCX0KCQkJc2Vjb25kU00gPSBVVE0ocm93U2l6ZSwgY29sdW1uU2l6ZSk7CgkJCWNvdXQgPDwgIlBsZWFzZSBpbnB1dCB2YWx1ZSBmb3Igc2Vjb25kIG1hdHJpeCAoSW5kZXggc3RhcnRpbmcgZnJvbSAxKSIgPDwgZW5kbDsKCQkJd2hpbGUgKHRydWUpIHsKCQkJCWludCByb3csIGNvbHVtbiwgdmFsdWU7CgkJCQljb3V0IDw8ICJbUm93XSAtPiAiOwoJCQkJY2luID4+IHJvdzsKCQkJCWNvdXQgPDwgIltDb2x1bW5dIC0+ICI7CgkJCQljaW4gPj4gY29sdW1uOwoJCQkJY291dCA8PCAiW1ZhbHVlXSAtPiAiOwoJCQkJY2luID4+IHZhbHVlOwoJCQkJaWYgKHNlY29uZFNNLmlzRXhjZWVkU2l6ZShyb3csIGNvbHVtbikpIHsKCQkJCQljb3V0IDw8ICJJbnZhbGlkIHJvdyBvciBjb2x1bW4hIFBsZWFzZSBlbnRlciB2YWx1ZSB3aXRoaW4gdGhlIG1hdHJpeCBzaXplISIgPDwgZW5kbDsKCQkJCQljb250aW51ZTsKCQkJCX0gZWxzZSBpZiAoc2Vjb25kU00uaXNTbG90UmVzZXJ2ZWQocm93LCBjb2x1bW4pKSB7CgkJCQkJY291dCA8PCAiVGhlIHJvdyBvciBjb2x1bW4gc3RhdGVkIGlzIG5vdCBhdmFpYWJsZSBmb3IgVXBwZXIgVHJpYW5ndWxhciBNYXRyaXghIiA8PCBlbmRsOwoJCQkJCWNvbnRpbnVlOwoJCQkJfSBlbHNlIGlmICh2YWx1ZSA9PSAwKSB7CgkJCQkJY291dCA8PCAiVGhlIHZhbHVlIG11c3Qgbm90IGJlIDAgISIgPDwgZW5kbDsKCQkJCX0gZWxzZSB7CgkJCQkJc2Vjb25kU00uZGlzcGxheUVsZW1lbnRzKHJvdywgY29sdW1uLCB2YWx1ZSk7CgkJCQkJY291dCA8PCAiVmFsdWUgYWRkZWQuLi4iIDw8IGVuZGw7CgkJCQl9CgkJCQljb3V0IDw8ICJDb250aW51ZSBpbnB1dCBuZXh0IHZhbHVlPyAoWS9OKSIgPDwgZW5kbDsKCQkJCWNpbiA+PiBpbnB1dDsKCQkJCWlmICghKGlucHV0ICE9ICJZIiAmJiBpbnB1dCAhPSAieSIpKSB7CgkJCQl9IGVsc2UgewoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJCWdvdG8gc2hvd01lbnU7CgkJCWJyZWFrOwoJCWNhc2UgNDoKCQkJaWYgKGZpcnN0U00uaXNTYW1lU2l6ZShzZWNvbmRTTSkpIHsKCQkJCVVUTSAqIHN1bVNNID0gZmlyc3RTTS5hZGRTTShzZWNvbmRTTSk7CgkJCQlzdW1TTS0+cHJpbnRNYXRyaXgoKTsKCQkJCXN5c3RlbSgicGF1c2UiKTsKCQkJCWRlbGV0ZSBzdW1TTTsKCQkJCXN1bVNNID0gTlVMTDsKCQkJCWdvdG8gc2hvd01lbnU7CgkJCX0gZWxzZSB7CgkJCQljb3V0IDw8ICJCb3RoIHRoZSBtYXRyaXggc2hvdWxkIGJlIGluIHNhbWUgZGltZW5zaW9uISIgPDwgZW5kbDsKCQkJCWdvdG8gc2hvd01lbnU7CgkJCX0KCQkJYnJlYWs7CgkJY2FzZSA1OgoJCQlmaXJzdFNNLn5VVE0oKTsKCQkJc2Vjb25kU00uflVUTSgpOwoJCQljb3V0IDw8ICJNZW1vcnkgQ2xlYXJlZCIgPDwgZW5kbDsKCQkJc3lzdGVtKCJwYXVzZSIpOwoJCQlmaXJzdFNNID0gVVRNKDQsIDQpOwoJCQlzZWNvbmRTTSA9IFVUTSg0LCA0KTsKCQkJZ290byBzaG93TWVudTsKCQkJYnJlYWs7CgkJY2FzZSA2OgoJCQljb3V0IDw8ICJFeGl0aW5nIFByb2dyYW0uLi4iIDw8IGVuZGw7CgkJCXN5c3RlbSgiZXhpdCIpOwoJCQlicmVhazsKCQlkZWZhdWx0OgoJCQlnb3RvIHNob3dNZW51OwoJCQlicmVhazsKCX0KCXJldHVybiAwOwp9

https://cryptii.com/ 
64
